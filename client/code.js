$(document).ready(function(){(function(exports){var socket=io.connect(socketURI);socket.on("connect",function(){messages.info("Connected")});socket.on("error",function(){messages.error("Error. Standby&hellip;")});socket.once("disconnect",function(){messages.info("Disconnected");users.clear()});socket.on("chat",function(data){messages.chat(data)});socket.on("user-list",function(data){users.update(data)});exports.socket=socket})(window);(function(exports){var template=Handlebars.compile($("#message-template").html());
var messageLimit=100;var messageList=[];var writeMessage=function(data){var message=template(data);messageList.unshift(message);messageList=messageList.slice(0,messageLimit);$("#messages ul").html(messageList.join(""))};exports.messages={"info":function(data){if(typeof data=="string")data=Message(data,User("web browser"));writeMessage(data)},"error":function(data){if(typeof data=="string")data=Message(data,User("web browser"),"error");writeMessage(data)},"chat":function(data){if(data.user.name==user.name)data.type=
"echo";writeMessage(data)}}})(window);(function(exports){var template=Handlebars.compile($("#userlist-template").html());var update=function(data){$("#users ul").html(template(data))};var clear=function(){$("#users ul").empty()};exports.users={"update":update,"clear":clear}})(window);(function(exports){var user=User();user.setName=function(name){this.name=name;socket.emit("set-name",{"username":name})};exports.user=user})(window);$('#status-update-form input[type="text"]').on("keydown",function(e){var message=
$(this).val();if(e.which==13&&message&&socket.socket.connected){if(!user.name)user.setName(message);else socket.emit("chat",{"user":user,"message":message});$(this).val("")}});$("#status-update-form button").on("click",function(e){socket.disconnect()})});
